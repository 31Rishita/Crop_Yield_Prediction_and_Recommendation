<!DOCTYPE html>
<html>
<head>
    <title>Smart Agriculture System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

<!-- NAVBAR -->
<nav class="navbar navbar-dark bg-success mb-4">
    <div class="container">
        <span class="navbar-brand fw-bold">üåæ Smart Agriculture System</span>
    </div>
</nav>

<div class="container">
    <div class="row">

        <!-- ================= LEFT: YIELD PREDICTION ================= -->
        <div class="col-md-6 mb-4">
            <div class="card shadow-sm h-100">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0">üìà Crop Yield Prediction</h5>
                </div>

                <div class="card-body">
                    <form method="POST">
                        <div class="row">
                            {% for f in yield_features %}
                            {% if f != "Production" %}
                            <div class="col-md-6 mb-3">
                                <label class="form-label fw-semibold">
                                    {{ f.replace("_"," ") }}
                                </label>

                                {% if "Season" in f %}
                                <select name="{{ f }}" class="form-control" required>
                                    <option value="0">Kharif</option>
                                    <option value="0">Rabi</option>
                                    <option value="0">Zaid</option>
                                    <option value="1">Whole Year</option>
                                </select>
                                {% else %}
                                <input
                                    type="number"
                                    step="any"
                                    name="{{ f }}"
                                    class="form-control"
                                    required
                                >
                                {% endif %}
                            </div>
                            {% endif %}
                            {% endfor %}
                        </div>

                        <button name="predict_yield" class="btn btn-success w-100">
                            Predict Yield
                        </button>
                    </form>

                    {% if yield_prediction %}
                    <div class="alert alert-info mt-3">
                        üåæ <strong>Predicted Yield:</strong>
                        {{ yield_prediction | round(2) }} tons / hectare
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- ================= RIGHT: CROP RECOMMENDATION ================= -->
        <div class="col-md-6 mb-4">
            <div class="card shadow-sm h-100">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">üå± Crop Recommendation</h5>
                </div>

                <div class="card-body">
                    <form method="POST">

                        <!-- STATE -->
                        <div class="mb-3">
                            <label class="form-label fw-semibold">State</label>
                            <select name="state" class="form-control" required>
                                <option value="" disabled selected>
                                    -- Select State --
                                </option>
                                <option value="Telangana">Telangana</option>
                                <option value="Andhra Pradesh">Andhra Pradesh</option>
                            </select>
                        </div>

                        <!-- SEASON -->
                        <div class="mb-3">
                            <label class="form-label fw-semibold">Season</label>
                            <select name="season" class="form-control" required>
                                <option value="Kharif">Kharif</option>
                                <option value="Rabi">Rabi</option>
                                <option value="Zaid">Zaid</option>
                            </select>
                        </div>

                        <!-- SOIL + CLIMATE FEATURES (REMOVE ONLY 4 FIELDS) -->
                        <div class="row">
                            {% for f in reco_features %}
                            {% if not f.startswith("state_")
                                  and not f.startswith("season_")
                                  and f.lower() not in ["production", "fertilizer", "pesticide", "yield"] %}
                            <div class="col-md-6 mb-3">
                                <label class="form-label fw-semibold">
                                    {{ f.replace("_"," ") }}
                                </label>
                                <input
                                    type="number"
                                    step="any"
                                    name="{{ f }}"
                                    class="form-control"
                                    required
                                >
                            </div>
                            {% endif %}
                            {% endfor %}
                        </div>

                        <button name="recommend_crop" class="btn btn-primary w-100">
                            Recommend Crops
                        </button>
                    </form>

                    {% if state_error %}
                    <div class="alert alert-danger mt-3">
                        ‚ö†Ô∏è {{ state_error }}
                    </div>
                    {% endif %}

                    {% if recommendations %}
                    <div class="alert alert-success mt-3">
                        <h6 class="fw-bold mb-2">
                            üåæ Top Crop Recommendations
                        </h6>
                        <ol class="mb-0">
                            {% for crop, conf in recommendations %}
                            <li>
                                <strong>{{ crop }}</strong>
                                
                            </li>
                            {% endfor %}
                        </ol>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>

    </div>
</div>

</body>
</html>
