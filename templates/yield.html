<!DOCTYPE html>
<html>
<head>
    <title>Crop Yield Prediction</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<!-- Navbar -->
<nav class="navbar navbar-dark bg-success mb-4">
    <div class="container">
        <span class="navbar-brand mb-0 h4">üåæ Smart Agriculture System</span>
    </div>
</nav>

<div class="container">
    <h3 class="mb-2">üìà Crop Yield Prediction</h3>
    <p class="text-muted">
        Enter soil and climatic parameters to predict expected crop yield.
    </p>

    <form method="POST">
        <div class="row">

            {% for f in features %}

            {# ‚ùå SKIP PRODUCTION TO AVOID DATA LEAKAGE #}
            {% if f != "Production" %}

            <div class="col-md-4 mt-3">
                <label class="form-label">
                    {{ f.replace("_", " ") }}

                    {% if f == "Area" %}
                        (hectares)
                    {% elif f == "Annual_Rainfall" %}
                        (mm)
                    {% elif f == "Fertilizer" %}
                        (kg/hectare)
                    {% elif f == "Pesticide" %}
                        (litres/hectare)
                    {% endif %}
                </label>

                {# ‚úÖ SEASON DROPDOWN (ROBUST FOR ONE-HOT ENCODING) #}
                {% if "Season" in f %}

                    <select name="{{ f }}" class="form-control" required>
                        <option value="" disabled selected>-- Select Crop Season --</option>
                        <option value="0">Kharif</option>
                        <option value="0">Rabi</option>
                        <option value="0">Zaid</option>
                        <option value="1">Whole Year</option>
                    </select>

                    <small class="text-muted">
                        Kharif, Rabi, and Zaid are seasonal crops; Whole Year crops are cultivated year-round.
                    </small>

                {% else %}

                    <input
                        type="number"
                        step="any"
                        name="{{ f }}"
                        class="form-control"
                        required
                        placeholder="Enter {{ f.replace('_', ' ') }}"
                    >

                {% endif %}
            </div>

            {% endif %}
            {% endfor %}

        </div>

        <button class="btn btn-success mt-4 px-4">
            Predict Yield
        </button>
    </form>

    {% if prediction %}
    <div class="alert alert-info mt-4">
        üåæ <strong>Predicted Crop Yield:</strong>
        {{ prediction | round(2) }} tons / hectare
        <br>
        <small class="text-muted">
            Prediction is based on historical agricultural and climatic data.
        </small>
    </div>
    {% endif %}
</div>

</body>
</html>
